/* DROP TABLE VT_SEQ CASCADE CONSTRAINT; */ 
CREATE TABLE VT_SEQ(
	SEQUENCE_NAME VARCHAR(255) NOT NULL 
	,NEXT_VAL BIGINT
	,CONSTRAINT PK_VT_SEQ PRIMARY KEY  ( SEQUENCE_NAME)
);

-- email token table 파일
CREATE TABLE VT_EMAIL_TOKEN(
    TOKEN 		VARCHAR(36) not null -- token
	,VIEWID 	VARCHAR(36)	not null -- 사용자 view id
    ,TOKEN_TYPE VARCHAR(10) not null -- token  type	(password reset, join)
    ,REG_ID		VARCHAR(36)					-- 등록 ID
	,REG_DT		TIMESTAMP DEFAULT CURRENT_TIMESTAMP 	-- 등록일
	,CONSTRAINT PK_VT_EMAIL_TOKEN PRIMARY KEY (TOKEN, VIEWID)
);

-- user table
CREATE TABLE VT_USER(
	VIEWID VARCHAR(36) NOT NULL
	,UID VARCHAR(255)
	,UNAME VARCHAR(1000)
	,UPW VARCHAR(255)
	,DEPT_NM VARCHAR(255)
	,ORG_NM VARCHAR(255)
	,ACCEPT_YN char(1)
	,BLOCK_YN char(1)
	,DESCRIPTION VARCHAR(1000)
	,LANG VARCHAR(100)
	,UEMAIL VARCHAR(255)
	,USER_ROLE VARCHAR(255)
	,REG_ID VARCHAR(36)
	,REG_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,UPD_ID VARCHAR(36)
	,UPD_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    ,CONSTRAINT PK_VT_USER PRIMARY KEY (VIEWID)
);


-- 사용자 설정 정보
CREATE TABLE VT_PREFERENCES(
  VIEWID VARCHAR(36)  NOT NULL,
  GROUP_ID VARCHAR(34) NOT NULL,
  PREF_KEY VARCHAR(255) NOT NULL,
  PREF_VAL CLOB(2147483647),
  REG_ID VARCHAR(255) NOT NULL,
  REG_DT TIMESTAMP NOT NULL,
  UPD_ID VARCHAR(255),
  UPD_DT TIMESTAMP,
  CONSTRAINT PK_VT_PREFERENCES PRIMARY KEY (GROUP_ID, PREF_KEY, VIEWID)
);

-- board table
CREATE TABLE VT_BOARD(
	ARTICLE_ID BIGINT NOT NULL 
	,BOARD_CODE VARCHAR(34) NOT NULL 
	,TITLE VARCHAR(250)
	,CONTENTS CLOB(2147483647)
	,COMMENT_CNT BIGINT DEFAULT 0
	,AUTHOR_NAME VARCHAR(255)
	,NOTICE_YN CHAR(1) DEFAULT 'N'
	,REG_ID VARCHAR(36)
	,REG_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,UPD_ID VARCHAR(36)
	,UPD_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,CONSTRAINT PK_VT_BOARD PRIMARY KEY  ( ARTICLE_ID, BOARD_CODE)
);

-- board comment
CREATE TABLE VT_BOARD_COMMENT(
	COMMENT_ID BIGINT NOT NULL 
	,ARTICLE_ID VARCHAR(34) NOT NULL 
	,GRP_COMMENT_ID BIGINT
	,PARENT_COMMENT_ID BIGINT
	,GRP_SEQ BIGINT
	,INDENT INTEGER DEFAULT 1
	,BOARD_CODE VARCHAR(50) NOT NULL 
	,CONTENTS CLOB(2147483647)
	,AUTHOR_NAME VARCHAR(255)
	,DEL_YN CHAR(1) DEFAULT 'N'
	,REG_ID VARCHAR(36)
	,REG_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,UPD_ID VARCHAR(36)
	,UPD_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,CONSTRAINT PK_VT_BOARD_COMMENT PRIMARY KEY  ( ARTICLE_ID, COMMENT_ID)
);

-- board file
CREATE TABLE VT_BOARD_FILE(
	FILE_ID BIGINT NOT NULL 
	,CONT_ID BIGINT NOT NULL 
	,CONT_TYPE VARCHAR(50) NOT NULL 
	,BOARD_CODE VARCHAR(50) NOT NULL 
	,FILE_FIELD_NAME VARCHAR(256)
	,FILE_NAME VARCHAR(500)
	,FILE_PATH VARCHAR(500)
	,FILE_EXT VARCHAR(10)
	,FILE_SIZE BIGINT
	,REG_ID VARCHAR(36)
	,REG_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,CONSTRAINT PK_VT_BOARD_FILE PRIMARY KEY  ( FILE_ID)
);


-- credentials provider
CREATE TABLE VT_CREDENTIALS_PROVIDER(
	CRED_ID VARCHAR(34) NOT NULL 
	,CRED_NAME VARCHAR(255) NOT NULL 
	,CRED_TYPE	VARCHAR(10) NOT NULL
	,USERNAME	VARCHAR(255)
	,PASSWORD	VARCHAR(512)
	,SECRET_TEXT	VARCHAR(2000)
	,DESCRIPTION VARCHAR(1000)
	,REG_ID VARCHAR(36)
	,REG_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,UPD_ID VARCHAR(36)
	,UPD_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,CONSTRAINT PK_VT_CREDENTIALS_PROVIDER PRIMARY KEY  (CRED_ID)
);

-- component group
CREATE TABLE VT_CMP_GROUP(
	GROUP_ID VARCHAR(34) NOT NULL 
	,NAME VARCHAR(255) NOT NULL 
	,DESCRIPTION VARCHAR(250)
	,LAYOUT_INFO CLOB(2147483647)
	,REG_ID VARCHAR(36)
	,REG_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,UPD_ID VARCHAR(36)
	,UPD_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,CONSTRAINT PK_VT_CMP_GROUP PRIMARY KEY  ( GROUP_ID)
);

-- component & group  mapping info
CREATE TABLE VT_CMP_GROUP_MAPPING(
	GROUP_ID VARCHAR(34) NOT NULL 
	,CMP_ID VARCHAR(34) NOT NULL 
	,REG_ID VARCHAR(36)
	,REG_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,CONSTRAINT PK_VT_CMP_GROUP_MAPPING PRIMARY KEY  ( GROUP_ID, CMP_ID)
);


-- component
CREATE TABLE VT_CMP(
	CMP_ID VARCHAR(34) NOT NULL 
	,NAME VARCHAR(34) NOT NULL 
	,CMP_TYPE  VARCHAR(10) NOT NULL 
	,CMP_CREDENTIAL  VARCHAR(32)	-- 인증 ID 
	,LOG_PATTERN  VARCHAR(1000)		-- 로그 패턴
	,DESCRIPTION  VARCHAR(1000)
	,REG_ID VARCHAR(36)
	,REG_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,UPD_ID VARCHAR(36)
	,UPD_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,CONSTRAINT PK_VT_CMP PRIMARY KEY  (CMP_ID)
);

-- component log item info
CREATE TABLE VT_CMP_ITEM_LOG(
	CMP_ID VARCHAR(34) NOT NULL 
	,LOG_TYPE VARCHAR(10) default 'FILE'
	,LOG_CHARSET VARCHAR(20)
	,LOG_PATH VARCHAR(500)
	,CONSTRAINT PK_VT_CMP_ITEM_LOG PRIMARY KEY  ( CMP_ID)
);

-- component log item info
CREATE TABLE VT_CMP_ITEM_LOG_EXTENSIONS(
	CMP_ID VARCHAR(34) NOT NULL 
	,REMOTE_HOST VARCHAR(255)
	,REMOTE_PORT INTEGER
	,COMMAND CLOB(2147483647)
	,CONSTRAINT PK_VT_CMP_ITEM_LOG_EXT PRIMARY KEY  (CMP_ID)
);

-- component command item info
CREATE TABLE VT_CMP_ITEM_COMMAND(
	CMP_ID VARCHAR(34) NOT NULL 
	,START_CMD CLOB(2147483647)
	,STOP_CMD CLOB(2147483647)
	,CMD_CHARSET VARCHAR(20)
	,CONSTRAINT PK_VT_CMP_ITEM_COMMAND PRIMARY KEY  ( CMP_ID)
);

-- component deploy item info
CREATE TABLE VT_CMP_ITEM_DEPLOY(
	CMP_ID VARCHAR(34) NOT NULL 
	,SCM_TYPE VARCHAR(20)
	,SCM_URL VARCHAR(1000)
	,SCM_ID VARCHAR(255)
	,SCM_PW VARCHAR(255)
	,SCM_BRANCH VARCHAR(1000)
	,USE_DEPLOY_PATH char(1) default 'N'
	,DEPENDENCY_PATH VARCHAR(1000)
	,DEPLOY_PATH VARCHAR(1000)
	,BUILD_SCRIPT CLOB(2147483647)
	,CONSTRAINT PK_VT_CMP_ITEM_DEPLOY PRIMARY KEY  ( CMP_ID)
);

-- 사용자 그룹 맵핑 정보.
CREATE TABLE VT_CMP_GROUP_USER_MAPPING(
	GROUP_ID VARCHAR(34) NOT NULL 
	,VIEWID  VARCHAR(36) NOT NULL 
	,REG_ID VARCHAR(36)
	,REG_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,CONSTRAINT PK_VT_CMP_GROUP_USER_MAPPING PRIMARY KEY  ( GROUP_ID, VIEWID)
);


-- app file 정보
CREATE TABLE VT_FILE(
	FILE_ID VARCHAR(36) NOT NULL
	,CONT_GROUP_ID VARCHAR(36)
	,FILE_CONT_ID VARCHAR(36)
	,FILE_DIV VARCHAR(255)
	,FILE_FIELD_NAME VARCHAR(256)
	,FILE_NAME VARCHAR(500)
	,FILE_PATH VARCHAR(500)
	,FILE_EXT VARCHAR(10)
	,FILE_SIZE BIGINT
	,REG_ID VARCHAR(36)
	,REG_DT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
	,CONSTRAINT PK_VT_FILE PRIMARY KEY  ( FILE_ID)
);

